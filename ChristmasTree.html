<!DOCTYPE HTML>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="css/Winter/christmastree.css"/>
	<link rel="stylesheet" type="text/css" href="css/Winter/snowflakes.css"/>
	<link rel="stylesheet" type="text/css" href="css/Winter/colors.css"/>
	<link rel="stylesheet" type="text/css" href="css/Winter/person.css"/>
	<link rel="stylesheet" type="text/css" href="css/Winter/snowman.css"/>
	<script type="text/javascript" src="js/utils.js"></script>
	<script type="text/javascript" src="js/Settings.js"></script>
	<script type="text/javascript" src="js/Winter/WinterSettings.js"></script>
	<script type="text/javascript" src="js/Winter/snowflakes.js"></script>
	<script type="text/javascript" src="js/Winter/christmastree.js"></script>
	<script type="text/javascript" src="js/Winter/person.js"></script>
	<script type="text/javascript" src="js/Winter/people.js"></script>
	<script type="text/javascript">

		function createSnowflakes(container) {
			/* Fill the empty container with new leaves */
			for (var i = 0; i < Settings.NUMBEROFSNOWFLAKES; i++) {
				var snowflake = new Snowflake(container);
				container.appendChild(snowflake.flake);
				snowflake.flake.addEventListener( 'click', function(event) {
					Field.player.play();
				}, false);
			}
		}

		function createChristmasTrees(container) {
			for( var i = 0; i < Settings.NUMBEROFCHRISTMASTREES; i++ )
			{
				var christmastree = new ChristmasTree(container);
			}
		}

		function alignCenterTree(container) {
			var tree = document.querySelector('.tree.center'),
			width = container.offsetWidth,
			treeWidth = tree.offsetWidth,
			left = width/2 - treeWidth/2;

			tree.style.left = left +"px";
		}

		function createPeople(people) {
			var field = document.querySelector('.left-field');
			people.forEach(function( ele ) {
				var person = new Person(ele);
				field.appendChild(person.ele);
			});
		}

		function stopTheDanceParty() {
			var people = document.querySelectorAll('.person'),
				length = people.length;

			for( var i=0; i<length; i++ ) {
				var person = people[i];
				person.removeClass('dance');
			}
		}

		function startTheDanceParty() {
			var people = document.querySelectorAll('.person'),
				length = people.length;

			for( var i=0; i<length; i++ ) {
				var person = people[i];
				person.addClass('dance');
			}
		}

		window.onload = function() {
			var container = document.getElementById('field');

			Field.player = new Audio('media/WinterWonderland.m4a');
			Field.player.addEventListener( 'play', startTheDanceParty, false );
			Field.player.addEventListener( 'ended', stopTheDanceParty, false );

			alignCenterTree(container);
			createChristmasTrees(container);
			createSnowflakes(container);
			createPeople(people);

		}

	</script>
</head>
<body>
	<div id="decorations"></div>
	<audio id="player" src="media/WinterWonderland.m4a" ></audio>
	<div id="field" class="snowflakes">
		<div class="tree center">
			<div class="body"></div>
			<div class="bottom"></div>
			<div class="shadow"></div>
			<div class="sbottom"></div>
			<div class="stump"></div>
		</div>
	</div>
	<div id="whitefield">
		<div class="left-field"></div>
		<div class="right-field"></div>
		<div class="snowman">
			<div class="bowler-hat bowler-hat-black"></div>
			<div class="ball head">
				<div class="left eye"></div>
				<div class="right eye"></div>
				<div class="nose"></div>
				<div class="mouth"></div>
			</div>
			<div class="ball body">
				<div class="buttons"></div>
			</div>
			<div class="ball bottom"></div>
		</div>
	</div>
</body>
</html>